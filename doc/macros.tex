% ------------------------------------------------------------------------------
% Including a source code file foo.ml:
%   \orig{foo}

\mdfsetup{%
  linewidth=0pt,%
  skipabove=\baselineskip,%
  skipbelow=.4\baselineskip,%
  innertopmargin=0pt,%
  innerbottommargin=0pt,%
}

\newenvironment{origenv}{%
  \begin{mdframed}[backgroundcolor=gray!10]%
}{%
  \end{mdframed}%
}

\newcommand{\orig}[1]{%
\begin{origenv}
\lstinputlisting{#1.ml}
\end{origenv}
}

% ------------------------------------------------------------------------------
% Including the corresponding auto-generated code:
%   \processed{foo}

\newenvironment{processedenv}{%
  \begin{mdframed}[backgroundcolor=yellow!40]%
}{%
  \end{mdframed}%
}

\newcommand{\processed}[1]{%
\begin{processedenv}
\lstinputlisting{#1.processed.ml}
\end{processedenv}
}

% ------------------------------------------------------------------------------
% Various macros.

\newcommand{\fref}[1]{Figure~\ref{#1}}

\newcommand{\ocamlbuild}{\texttt{ocamlbuild}\xspace}
\newcommand{\opam}{\texttt{opam}\xspace}

\newcommand{\iter}{\texttt{iter}\xspace}
\newcommand{\map}{\texttt{map}\xspace}
\newcommand{\itertwo}{\texttt{iter2}\xspace}
\newcommand{\maptwo}{\texttt{map2}\xspace}
\newcommand{\name}{\texttt{name}\xspace}
\newcommand{\unit}{\texttt{unit}\xspace}
\newcommand{\variety}{\texttt{variety}\xspace}
\newcommand{\visitors}{\texttt{visitors}\xspace}

\newcommand{\tyconvisitor}[1]{\texttt{visit\_#1}}
\newcommand{\dataconvisitor}[1]{\texttt{visit\_#1}}
